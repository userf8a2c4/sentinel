# Ejemplo de configuración para Proyecto C.E.N.T.I.N.E.L.
# Copia este archivo como config/config.yaml y ajusta los valores a tu entorno.

# URL base del endpoint de resultados (placeholder).
base_url: "https://results.example.org/api/v1/summary"

# Endpoints principales (placeholders).
endpoints:
  nacional: "https://results.example.org/api/v1/nacional"
  fallback_nacional: "https://results.example.org/api/v1/nacional/fallback"

# SWITCH MAESTRO (ON/OFF): controla todo proceso automático del repo.
# ON  = permite ejecución automática
# OFF = detiene ejecución automática
master_switch: "OFF"

# Parámetros de red.
timeout: 20
retries: 5
headers:
  Accept: "application/json"
  User-Agent: "C.E.N.T.I.N.E.L./1.0 (config-example)"
use_playwright: false
playwright_stealth: true
playwright_user_agent: "C.E.N.T.I.N.E.L./1.0 (config-example)"
playwright_viewport:
  width: 1280
  height: 720
playwright_locale: "es-HN"
playwright_timezone: "America/Tegucigalpa"

# Fallback Playwright (anti-bloqueo básico).
use_playwright: false
playwright_stealth: true
playwright_user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120 Safari/537.36"
playwright_locale: "es-ES"
playwright_timezone: "America/Tegucigalpa"
playwright_viewport:
  width: 1280
  height: 720

# Backoff exponencial para reintentos (segundos).
backoff_base_seconds: 2
backoff_max_seconds: 60

# Cantidad esperada de candidatos (referencial).
candidate_count: 4

# Llaves que deben existir en el payload (puede quedar vacío).
required_keys:
  - "estadisticas"
  - "resultados"

# Mapeo de campos de origen a nuestro esquema interno.
field_map:
  totals:
    valid_votes:
      - "estadisticas.distribucion_votos.validos"
    null_votes:
      - "estadisticas.distribucion_votos.nulos"
    blank_votes:
      - "estadisticas.distribucion_votos.blancos"
    total_votes:
      - "estadisticas.distribucion_votos.total"
  candidate_roots:
    - "resultados"

# Fuentes configurables (nacional + departamentos).
sources:
  - name: "Nacional (demo)"
    source_id: "NACIONAL"
    level: "PRES"
    scope: "NATIONAL"
  - name: "Departamento Demo"
    department_code: "99"
    level: "PD"
    scope: "DEPARTMENT"

logging:
  level: INFO
  file: centinel.log

blockchain:
  enabled: false
  network: polygon-mumbai
  private_key: "0x..." # Advertencia: nunca commitear, usar secrets manager o .gitignore

alerts:
  critical_anomaly_types:
    - ARITHMETIC_MISMATCH
    - NEGATIVE_DELTA
    - CHANGE_POINT
    - RELATIVE_DELTA
    - SCRUTINY_JUMP
    - VOTE_BREAKDOWN_MISMATCH

arbitrum:
  enabled: false
  rpc_url: "https://arb1.arbitrum.io/rpc"
  private_key: "0x..." # Advertencia: nunca commitear, usar secrets manager o .gitignore
  contract_address: "0x..." # Después del deploy
  interval_minutes: 15
  batch_size: 19

rules:
  global_enabled: true
  trend_shift:
    enabled: true
    threshold_percent: 10
    max_hours: 3
  processing_speed:
    enabled: true
    max_actas_per_15min: 500
  irreversibility:
    enabled: true
    historical_participation_rate: 0.60
    sqlite_path: "reports/irreversibility_state.db"
  benford_law:
    enabled: true
    chi_square_threshold: 0.05
    deviation_pct: 15
    min_samples: 10
  ml_outliers:
    enabled: true
    contamination: 0.1
    min_samples: 5
  basic_diff:
    enabled: true
    relative_vote_change_pct: 15
  participation_anomaly:
    enabled: true
    scrutiny_jump_pct: 5
  benford_first_digit:
    enabled: true
    mad_warning: 0.008
    mad_critical: 0.015
    chi_pvalue_critical: 0.01
    min_samples: 15
  last_digit_uniformity:
    enabled: true
    chi_pvalue_critical: 0.001
    min_samples: 20
  table_consistency:
    enabled: true
    total_tolerance: 1
  participation_anomaly_advanced:
    enabled: true
    min_turnout_pct: 40
    max_turnout_pct: 90
    historical_mean: 0.6
    historical_std: 0.1
  null_blank_votes:
    enabled: true
    warning_pct: 8
    critical_pct: 12
  snapshot_jump:
    enabled: true
    max_change_pct: 5
    max_minutes: 10
  participation_vote_correlation:
    enabled: true
    critical_r: 0.85
    min_samples: 30
  geographic_dispersion:
    enabled: true
    critical_cv: 0.45
    min_departments: 5
  runs_test:
    enabled: true
    critical_pvalue: 0.01
    min_samples: 30
  mesas_diff:
    enabled: true
  large_numbers_convergence:
    enabled: true
    min_samples: 30
    z_threshold: 3
    min_total_votes: 200
